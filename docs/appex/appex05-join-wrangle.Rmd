---
title: "AE 05: Join data sets + data wrangling"
author: "Your Name"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: readable
editor_options: 
  chunk_output_type: console
---

## Code styling + workflow 

- Avoid long lines of code. 
  - We should be able to see <u>all</u> of your code.
- Name code chunks.
- Knit, commit, and push regularly. 
  - Think about it like clicking to save regularly as you type a report.


## Questions? 


## Clone a repo + start a new project

Go to the `appex-05-[GITHUB USERNAME]` repo, clone it into your Math118 folder, and start a new project in RStudio. 

## Note

For this Application Exercise, you are provided with lots of starter code/hints. In order to allow the whole document to run, we have set each `R` chunk headers to `eval = FALSE`. As you complete each exercise, change the `R` chunk header to `eval = TRUE` before you knit in order to run your changes.


## Practice with data joins and wrangling


You may need to install the `scales` library. If so, run `install.packages("scales")` in your **console**.

```{r setup, eval  = FALSE}
library(tidyverse)
library(scales)
fisheries <- read_csv("data/fisheries.csv")
continents <- read_csv("data/continents.csv")
```

We will write code that fills in the gaps from joining the data sets to creating the updated visualizations. 

### Exercise 1

We wish to add to the `fisheries` data the continent that a country is located in.

Write code that joins together the `fisheries` dataset and the `continent` dataset by the variable they have in common. Store it by saving over the current `fisheries` data frame. The code below will help you get started. 

```{r join, eval = FALSE}
<- fisheries %>%
  left_join(______, by = ______)  
```

Once you are happy with your join, run the following code by setting `eval = TRUE`. 

```{r catch-up, eval = FALSE}
fisheries <- fisheries %>%
  filter(total > 100000) %>%
  mutate(
    continent = case_when(
      country == "Democratic Republic of the Congo" ~ "Africa",
      country == "Hong Kong"                        ~ "Asia",
      country == "Myanmar"                          ~ "Asia",
      TRUE                                          ~ continent
      ),
    aquaculture_perc = aquaculture / total
    )
```


### Exercise 2

Create a new data frame called `fisheries_summary` that calculates 
median and mean aquaculture percentage for each continent in the 
fisheries data. 

Recall that the function for calculating the mean and median are `mean()` and `median()` in R.

```{r fisheries-summary-continent, eval=FALSE}
fisheries_summary <- fisheries %>%
  # code here                      
```

### Exercise 3

Take the `fisheries_summary` data frame and order the results in descending 
order of median aquaculture percentage.

```{r fisheries-summary-continent-sorted}

```

### Exercise 4

The code below creates the graph you originally saw in the lecture slides. Change it such that we visualize the median aquaculture percentage instead. Adjust the labels accordingly!

```{r plot-continent-summary, eval = FALSE}
ggplot(fisheries_summary, 
       aes(y = fct_reorder(continent, mean_ap), x = mean_ap)) +
  geom_col() +
  scale_x_continuous(labels = label_percent(accuracy = 1)) +
  labs(
    x = "",
    y = "",
    title = "Average share of aquaculture by continent",
    subtitle = "out of total fisheries harvest, 2016",
    caption = "Source: bit.ly/2VrawTt"
  ) +
  theme_minimal()
```

<br><br>

<hr> 

*This exercise was modified from "Fisheries" in [Data Science in Box](https://datasciencebox.org/).*